<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
  <title>Waterkolom App</title>
  <meta name="theme-color" content="#0b6efd">
  <link rel="manifest" href="manifest.webmanifest">
  <!-- iOS PWA meta -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <link rel="apple-touch-icon" href="icon-192.png">
  <link rel="stylesheet" href="app.css">
</head>
<body>
  <header class="app-header">
    <div class="title">Waterkolom</div>
    <button id="btnTheme" class="icon-btn" title="Thema wisselen">ðŸŒ“</button>
  </header>

  <main id="views">
    <!-- HOME -->
    <section data-view="home" class="view active">
      <div class="card">
        <div class="muted">Laatste meting</div>
        <div class="big">
          <span id="lastVal">â€”</span> <span class="unit">m</span>
        </div>
        <div id="status" class="badge">Status: â€”</div>
        <div id="updated" class="muted small">â€”</div>
        <div class="actions">
          <button id="btnRefresh" class="btn primary">Vernieuwen</button>
        </div>
      </div>
      <div class="card">
        <div class="muted">Snelle info</div>
        <ul class="list">
          <li><span>Autoâ€‘refresh</span><span id="autoRefreshLabel">15s</span></li>
          <li><span>OK &lt; </span><span id="okThrLabel">1.00 m</span></li>
          <li><span>Waarschuwing &lt; </span><span id="warnThrLabel">2.00 m</span></li>
        </ul>
      </div>
    </section>

    <!-- TREND -->
    <section data-view="trend" class="view">
      <div class="card">
        <div class="row between center">
          <div>Trend (laatste <span id="pointsCount">100</span> punten)</div>
          <div>
            <select id="selResults">
              <option value="100" selected>100</option>
              <option value="250">250</option>
              <option value="500">500</option>
            </select>
          </div>
        </div>
        <canvas id="chart" height="260"></canvas>
      </div>
    </section>

    <!-- ALERTS -->
    <section data-view="alerts" class="view">
      <div class="card">
        <h3>Alarm drempels</h3>
        <div class="grid2">
          <label>OK max (m)<input id="okThr" type="number" step="0.01" min="0" max="3"></label>
          <label>Waarschuwing max (m)<input id="warnThr" type="number" step="0.01" min="0" max="3"></label>
        </div>
        <div class="actions">
          <button id="btnSaveThr" class="btn primary">Opslaan</button>
          <button id="btnTestAlert" class="btn">Test alert</button>
          <button id="btnClearAlerts" class="btn danger">Wis log</button>
        </div>
      </div>
      <div class="card">
        <h3>Alert log (dummy)</h3>
        <ul id="alertList" class="list"></ul>
      </div>
    </section>

    <!-- CONTROLS -->
    <section data-view="controls" class="view">
      <div class="card">
        <h3>Apparaten (dummy)</h3>
        <div class="toggle">
          <label>Pomp</label>
          <input type="checkbox" id="togPump">
        </div>
        <div class="toggle">
          <label>Autoâ€‘flush</label>
          <input type="checkbox" id="togFlush" checked>
        </div>
        <div class="toggle">
          <label>Vlotter override</label>
          <input type="checkbox" id="togFloat">
        </div>
        <div class="muted small">Deze knoppen veranderen enkel de UIâ€‘status (geen echte hardware actie).</div>
      </div>
    </section>

    <!-- SETTINGS -->
    <section data-view="settings" class="view">
      <div class="card">
        <h3>Data bron</h3>
        <div class="grid2">
          <label>Channel ID<input id="stChannel" type="number" min="1"></label>
          <label>Read API Key<input id="stKey" type="text" placeholder="Leeg laten bij public channel"></label>
        </div>
        <div class="grid2">
          <label>Field #<input id="stField" type